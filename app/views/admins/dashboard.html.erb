<h1>Welcome Admin!</h1>
<p>You're logged in as <%= current_user.email %></p>

<%= link_to "Trader Details", admin_traders_path, class: "button" %>
<br>
<%= link_to "Create New Trader", new_admin_trader_path, class: "button" %>
<br>
<%= link_to "Transaction Details", admin_transactions_path, class: "button" %>

<hr>

<h2>All Traders</h2>
<table>
  <thead>
    <tr>
      <th>Email</th>
      <th>Role</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% if @traders.nil? || @traders.empty? %>
      <tr><td colspan="3">No traders found.</td></tr>
    <% else %>
      <% @traders.each do |trader| %>
        <tr>
          <td><%= trader.email %></td>
          <td><%= trader.role %></td>
          <td>
            <% if trader.role == 'trader' %>
              <%= link_to 'Promote to Admin', promote_user_path(trader.id), method: :patch, data: { turbo_method: :patch } %>
            <% else %>
              <%= link_to "Demote to Trader", demote_user_path(trader), method: :patch, class: "button" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>

<hr>

<h2>Pending Traders</h2>
<% if @pending_traders.present? %>
  <table>
    <thead>
      <tr>
        <th>Email</th>
        <th>Registered On</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @pending_traders.each do |trader| %>
        <tr>
          <td><%= trader.email %></td>
          <td><%= trader.created_at.strftime("%B %d, %Y") %></td>
          <td><%= trader.approved ? "Approved" : "Pending Approval" %></td>
          <td>
            <% if !trader.approved %>
            <%= button_to "Approve", approve_admin_trader_path(trader), method: :patch, class: "button" %>
            <% else %>
              <span>Already Approved</span>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>No pending traders.</p>
<% end %>

<hr>

<%= button_to "Log Out", logout_path, method: :delete %>
