<h1>Welcome Admin!</h1>

<p>You're logged in as <%= current_user.email %></p>

<%= link_to "Trader Details", admin_traders_path, class: "button" %>
<br>
<%= link_to "Create New Trader", new_admin_trader_path, class: "button" %>
<br>
<%= link_to "Transaction Details", admin_transactions_path, class: "button" %>


<h2>All Traders</h2>
<table>
  <thead>
    <tr>
      <th>Email</th>
      <th>Role</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% if @traders.nil? || @traders.empty? %>
      <tr><td colspan="3">No traders found.</td></tr>
    <% else %>
      <% @traders.each do |trader| %>
        <tr>
          <td><%= trader.email %></td>
          <td><%= trader.role %></td>
          <td>
            <%= link_to 'Promote to Admin', promote_user_path(trader.id), method: :patch, data: { turbo_method: :patch } %>
            <%= link_to "Demote to Trader", demote_user_path(trader), method: :patch, class: "button" if trader.role == "admin" %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>

<hr>

<h2>Pending Traders</h2>
<table>
  <thead>
    <tr>
      <th>Email</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% if @pending_traders.any? %>
      <% @pending_traders.each do |trader| %>
        <tr>
          <td><%= trader.email %></td>
          <td>
            <%= link_to "Approve", approve_admin_trader_path(trader), method: :patch, class: "button" %>
          </td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="2">No pending traders.</td>
      </tr>
    <% end %>
  </tbody>
</table>
